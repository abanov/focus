//Автор(с): Абанов Владислав
var g_in_text = -1;

var g_count_levels = 30;
var g_levels = [];


function g_objAt(name){
	if(typeof(document.getElementById) != "undefined")
		return document.getElementById(name);
	return document.all[name];
}


function g_objText(o, s){
	if(g_in_text == 1)
		o.innerText = s;
	else if(g_in_text == 2)
		o.innerHTML = s;
	else {
		if(typeof(o.innerText) != "undefined"){
			g_in_text   = 1;
			o.innerText = s;
		} else {
			g_in_text   = 2;
			o.innerHTML = s;
		}
	}
}


function fill_levels(){
	var ls = "BBBBBBBBBBBBBB00000XXX000000M0BBBBBBBBBB0000B00000000BX000B0M0MM000B0000BBBB000BBB00X0000B000B0M00000M0B0U00000000000000000X00BBBBBBBBBBBBBB,"+
	"00B00000X0B000M0B0M0M000000000BX000000B00000BBBBBBBBB000000X00U00M0000000000000000000000M00MB000M000BBB000BXBBBBX000B000BBB000000X000000X000,"+
	"00X00000X0X00000BBBBBBBBBB0000BX00XBX0XBM00MB0000B000B0000B000MB000B0000B0000B000BM00000000M000000000000U000000000BM0BB0B0MBM0000000000000X0,"+
	"BBBBBBBBBBBBBBB000000000000BB00M0M0M0M0M0BBBBBBBBBBBBB0B00000000000000XXXXX0U00M00M0XBBBBBBBBBBBB000M00000000XB00BBBBBBBBBBBBX00X0000M000000,"+
	"XB00XXXXXX00BX0B0000000000B00B0BBBBB0BB0B0MB0B0M0M00B0BXXB0B000000B0B00B0B0MMMM0B0BM0B0B000000B0B00B0BBBBBBBB0BX0M00000UM0M000X00M0B00000000,"+
	"000B00B00000000M0000000M0M00BBBBBBBBXBBBBB0M000000X0000X000000X0XU0M00B0BBBBBBBBBBBB0000000000000000M0M0M0M0M0000BBBBBBBBBBMB0XXXXXXX0000M00,"+
	"0M00000X0000000B00M0BXM0MM0000BXBB0BX00B00M00B0000BX0BM00000M0M00BXB000M00000000BB0000BX0B0UB00B00M0B0XB00B00000X0BBBBBBB000M0X0000XX00000B0,"+
	"X0000000X0000X0BBBXB0B0BBB000B0B0B0B0B0B000BBB0BBB0BBBX0MB000B0B0B00000B000B0B0B00000000M000000X0000X0000000MXM00MXM00U0M0MXMMX0XM0M0000MX00,"+
	"BBBBBBBBBBBBBBB000000B000X0BB00M0M0000000BB00MM00BX0000BB00000MBXXX00BBBBBBB0BBBB0BBBX000M0B0M0MXBB0MX000B0MU0XBBX00M0XBX00M0BBBBBBBBBBBBBBB,"+
	"00B00B00B00B000M0M0B00B0MB0M0000000M0000000BXBXBXB0BXB00BXB0B0B0BXB0B0X0B0B0B0BXB0B0MMB0B0B0B0B0B0X000000X000000MB0B0B0BMMMB0000X00MU00M00XX,"+
	"X0B00X00000M0000BBBB0BBBBBB000000BBB00X0B00M0000000M00B00MMMM0000000B0MM00M0BBB0BBB0000000B0M000X0BBB0U0B00MM00000BBBBB0000000XXXXXX0000XX0X,"+
	"00X0000M00000X0BXBBBBBBBBBB00B00X00000M0B00B0BMBBBBBB0B00B0B00M00XB0BX0B0BX000M00XB00B0BBBBBBBB0B00BM00000M000B00B0BBBBBB0BBBM000000U0000000,"+
	"X0X0X00B00000X00M0M0M0M0M0000X0X0X0B000B00BBBBBBBB00M00M0M0M0M00XXXB0X00000000000000BBBBBBBB000B00X000000B000000MU0MMMMB00000M0000000000XXXX,"+
	"00000XBX000000X0M0M0XBX00M00BMBBBBBBBBBBMB00XB000000B000000B0M0M0000XXBMBBBBBBBBBXBB0000B0000B0M0XMB00M0000B0M000M00B0U00B0M00XXX0B00000000X,"+
	"X0M0000000000X00XXXXXXX0000000BXBXBXBMBX00M0000M0000000000000BBBBX000MM00000M000000X000000U000000000MMMMMMMMMM0000B00B00B00B00X000000000000X,"+
	"X0000000M0X00X0B000MBBBBM00B0BX0000M0BXM0X0BBBBX000BX00B0000000M00000X00M0000B00000BBBBB000BX0000XXMXB00UBBBB0MB0M0B00M0M0M0M0X000X00000M000,"+
	"X0BXXBXXBXXBXX0XB00BMXBMXB00M0BMMBX000MBM000B00B0MB00B0M0MBM0BM0B0MB0000B000U0B00B000MBM0BM0BMMB0X00B0MB00B00B00X0000B0MB0M0000XBXXBX0BX0B0X,"+
	"X00B00B0XBX0BX0MXBM0000BX0B0MBBB00B00B00B0X00000BB0B0XB0BBBBBBB0MBM0B0000000000B0MBMBBB0BBBBBBM0B0X0M0XX00000000BBBBBBBBBMMBB0X0000MU0000000,"+
	"X0000000BBBBB00BBMBBM0BX00MX0B000B00B000B00BX00BM0BBBBB00BBBBB000000B00BX000M0M0MM00000BBBBBBB00B0M00BXXXXX00XBM00MBBBBBBBBBB00U000000000000,"+
	"000000XXB0MX00MB0000XB000MM000B000B00M00000M0B00000B0M0B0M0XB00000BXB00MXBXB0000XB000XBX0XB00000B0XBX00MXB0BMM0BBXMMMUMX0000M0X00M00000B0000,"+
	"X000000000M00X0MBBBBBBBBBB00000000M0000000M00BBBBBBBB0000000XXUXX0M0000M0XBBBBBBX000000000000000000B0B0BBBB0BMB000M00M00M00000X000000000000X,"+
	"X0X0000X00000X0B0MBM0B00B00B0000000M00X0000MB00B00BM0BM00M00000000000XB00B00B00B00B0000M000M0X00000B00B0UB00B00B00M00000000M00X0B00BX0BX0BX0,"+
	"000000000000000XXXXX0BMB0BXB000X000BXB0B0B0M0X000BBB0B0B0M0X00000B0B0B000X000BBB0BXB000000M0000000MBMBMMMBMMMBM0000M00U0M00000X0000X0000000X,"+
	"0X000000000M0X00MMMMMMMM00000000XXXXXX000M00MXMMMMMMXM00M00XM00U0MX00000MXMMMMMMXM000000XXXXXX00000000000000000M000BBBBBBBB000X00XXXXXXXX00X,"+
	"000000000000000M0BX00BBM0X000M0BX0MXX0MX000M0BX00BB00X000M0BXM0XX00X000M0BX0MBB000000000000000M0M000000BM0U000M00000000000M000XBBBBBBBBBBBBX,"+
	"BBBBBB0BBBBBBB0000X0X000000B0BBBMBMBBBBB0BXM000X00000B0B0B0BBMBB00MB0B0B0B000BB0X00BXM000000BBBB0B0BBBBBB0BBBBBB0000MXB000UBBB0X0M00BBBBBBBB,"+
	"BBBBBBBBBBBBBBBXXX00X000XXXBBXXX00000000XBBXXX000X0000XBBBBBBBBBBB0BBB0M000000000000000M0M0M0M0M0000UM0M0M0M0M00000M0M0M0M0M0000000000000000,"+
	"000XX0M000000B0B000BBBBM00000BBB0000B00M0B000BBM0MBBBB00M000B00000XB0B00BBB000000B000BBX0000BBBB0B0BXXM000B0000X0BBMBBBBBU000BX0000000000B00,"+
	"0B0B0B0B0B000B0MXB000B0MXB000B0B0B0B0B0BMBXM0BXM000B0B000B0B0B0B0B0B0B000B0B0B0B0B000B0B0B0B0B0B0B000B0BUB0B0B000B0BXM0MXB0B0B0BX00M0M00XBX0,"+
	"00B00B00B00B000MM00MM0M0M000000M0000000000BXBXBXB0B0B0B0BBBBBBBBBB00BBXBXB0B0B0B000BX000000000000X000BM0UMM0000XBBBB0M0000BBBBX00000000000XX";

	g_levels = ls.split(/,/);
	ls = null;
}


function getLevelAt(maze, level, rows, cols){
	if((level < 0) || (level >= g_levels.length))
		return false;

	var c, i, j;
	for(i = 0; i < rows; ++i){
		for(j = 0; j < cols; ++j){
			switch(g_levels[level].charAt(i * cols + j)){
			case 'M':
				c = 1;
				break;
			case 'X':
				c = 2;
				break;
			case 'B':
				c = 3;
				break;
			case 'U':
				c = 4;
				break;
			default:
				c = 0;
				break;
			}
			maze[i][j] = c;		
		}
	}
	return true;
}


function getCookieLevel(){
	try{
		var s = document.cookie.match(/(level\=)\d+/);
		if((s == null) || (s.length == 0))
			return 0;
		return parseInt(s[0].substring(6, s[0].length));
	} catch(e){}
	return 0;
}


function putCookieLevel(level){
	if(typeof(document.cookie) != "undefined")
		document.cookie = "level=" + level;
}